# Boost 1.81.0リリースノート

本家リリースノート：

- <https://github.com/boostorg/website/blob/master/feed/history/boost_1_81_0.qbk>
- <http://www.boost.org/users/history/version_1_81_0.html>


リポジトリは以下：

- <https://github.com/boostorg/>


リポジトリからのビルド方法は、egtraさんのブログを参照：

- 「[Modularized Boost（GitHubへ移行したリポジトリ）を使用する](http://dev.activebasic.com/egtra/2013/12/03/620/)」


## 新ライブラリ

- [URL](https://boost.org/libs/url)
    - C++11のみを使用してURLの解析、変更、表示をするライブラリ。機能として、高速なコンパイル、強い不変条件、およびメモリフレンドリーなアプローチによる厳密なコンプライアンスが含まれる (作者Vinnie Falco, Alan de Freitas)


## 更新ライブラリ

- [Beast](#beast)
- [Container Hash](#container-hash)
- [Core](#core)
- [Describe](#describe)
- [Filesystem](#filesystem)
- [Flyweight](#flyweight)
- [Fusion](#fusion)
- [Geometry](#geometry)
- [Iterator](#iterator)
- [JSON](#json)
- [Locale](#locale)
- [Multi-index](#multi-index)
- [Nowide](#nowide)
- [STLInterfaces](#stl-interfaces)
- [System](#system)
- [Unordered](#unordered)
- [Variant2](#variant2)


## <a id="beast" href="#beast">Beast</a>

- `buffers_generator`を追加
- `beast::http::message_generator`を追加
- AsioでBeastのbufferを使用するための`buffer_ref`を追加
- 操作ごとのキャンセルをサポート
- C++20 awaitのサンプルコードを追加
- WebSocketのメッセージごとの圧縮オプション
- WebSocketのタイムアウトオプションのAPI
- multiple content lengthのエラー
- デフォルトの圧縮とrebindをサポート


## <a id="container-hash" href="#container-hash">Container Hash</a>

- **メジャーアップデート**
- `boost::hash`の特殊化を削除し、常に`hash_value`を呼び出すようにした
- `BOOST_HASH_NO_EXTENSIONS`のサポートを削除した。拡張は常に有効になる
- すべての標準コンテナをサポート。これには`std::forward_list`、と非順序連想コンテナが含まれる
- ユーザー定義のコンテナ (イテレータを返す`begin()` / `end()` をもつ型) をサポート
- describedなstruct / class (`BOOST_DESCRIBE_STRUCT`もしくは`BOOST_DESCRIBE_CLASS`でアノテーションがつけられた型) をサポート
- `hash_combine`を改善
- 文字列ハッシュのパフォーマンス (および結果の品質) を改善。文字列の`boost::hash`は64ビットモードでSMHasherに渡すようになった
- ドキュメントを、変更を反映するために大幅に改訂した


## <a id="core" href="#core">Core</a>

- `empty_value`メンバを`constexpr`にした
- `flose_deleter`を追加。このデリータは、`std::FILE`へのポインタに対して`std::fclose()`を呼び出す
- [GitHub #129](https://github.com/boostorg/core/issues/129) `boost/core/bit.hpp`のビット操作ユーティリティが、入力時に符号なし整数を明示的に要求するようになった
- `bit_width`が入力の値の型ではなく、intを返すようにした。これは[LWG3656](https://cplusplus.github.io/LWG/issue3656)の解決に基づく


## <a id="describe" href="#describe">Describe</a>

- `-pedantic` オプションが使用されたときに `enumerators.hpp`、`bases.hpp`、および `members.hpp` を含めることができるようにするために、`BOOST_DESCRIBE_ENUM` の呼び出しは `modifiers.hpp` から 別のヘッダー `modifier_description.hpp` に移動した。 その結果、`modifiers.hpp`には`enum.hpp`が含まれなくなった。 この暗黙的なインクルードに依存しているコードは失敗する可能性があり、`enum.hpp` をインクルードするように修正する必要がある


## <a id="filesystem" href="#filesystem">Filesystem</a>

- [**非推奨**] `std::vector<char>` や `std::list<wchar_t>` などの文字のコンテナからの `path` の構築、代入、および追加は、v3 で非推奨になり、v4で削除された。代わりに文字列型またはイテレータを使用すること
- [**非推奨**] `boost/filesystem/path_traits.hpp` ヘッダは非推奨となり、将来のリリースで削除される予定。このヘッダには`path`の実装の詳細が含まれており、ユーザーのコードでは使用すべきではない
- 以前から非推奨だったAPIが、使用時にコンパイル警告を出力するようになった。これらの警告を抑制するために、ユーザーのコードをコンパイルする際は `BOOST_FILESYSTEM_ALLOW_DEPRECATED` マクロを定義すること
- [GitHub #250](https://github.com/boostorg/filesystem/issues/250) `*at` API をサポートしない POSIX システムでのインクルードの不足によるコンパイルエラーを修正
- [GitHub #246](https://github.com/boostorg/filesystem/pull/246), [GitHub #245](https://github.com/boostorg/filesystem/issues/245) Windows 10より前バージョンで`directory_iterator`を構築する際に`ERROR_INVALID_PARAMETER`を生成するネットワーク共有ファイルシステムのワークアラウンドが追加された
- [GitHub #247](https://github.com/boostorg/filesystem/issues/247) Windowsで、パスが `"\\\\?\\"` プレフィックスで始まる場合に `ERROR_INVALID_FUNCTION` エラーコードで失敗する `weakly_canonical` を修正
- [GitHub #208](https://github.com/boostorg/filesystem/issues/208) `path` コンストラクタ、代入および追加操作で `std::string_view`、`boost::string_view` および `boost::container::string` (およびそれぞれの `wchar_t` 対応物) のサポートを追加
- イテレータのペアを使用する`path`コンストラクタ、代入および追加操作が、サポートされているパス文字タイプのいずれでもない値型のイテレータを受け入れなくなった


## <a id="flyweight" href="#flyweight">Flyweight</a>

- メンテナンス作業


## <a id="fusion" href="#fusion">Fusion</a>

- [GitHub #240](https://github.com/boostorg/fusion/pull/240) `fusion::identity_view`を追加
- [GitHub #239](https://github.com/boostorg/fusion/pull/239) `fusion::transform_view`に連想シーケンスのサポートを追加
- [GitHub #237](https://github.com/boostorg/fusion/pull/237) 連想シーケンスで`fusion::reverse_view`を使用した場合のコンパイルエラーを修正
- [GitHub #261](https://github.com/boostorg/fusion/pull/261) Clang 13での`-Wdeprecated-copy`警告を修正
- [GitHub #249](https://github.com/boostorg/fusion/pull/249) 依存関係の小さな再編成。Boost.Coreから`boost::ref`と`boost::noncopyable`が使用されるようになった
- [GitHub #245](https://github.com/boostorg/fusion/pull/245), [GitHub #236](https://github.com/boostorg/fusion/pull/236) LinuxとMacOSでのclangとgccのCIテストを追加し、WindowsでのCIテストを修正した
- [GitHub #234](https://github.com/boostorg/fusion/issues/234), [GitHub #235](https://github.com/boostorg/fusion/pull/235), [GitHub #238](https://github.com/boostorg/fusion/pull/238) ドキュメントの改善と誤字の修正


## <a id="geometry" href="#geometry">Geometry</a>

- 解決したissue
    - [GitHub #1048](https://github.com/boostorg/geometry/issues/1048) Index: IndexableGetterによって値でIndexableが返される場合のダングリング参照を修正
    - [GitHub #1076](https://github.com/boostorg/geometry/issues/1076) Union: まれに1つのポリゴンが欠落している可能性があった問題を修正
    - [GitHub #1081](https://github.com/boostorg/geometry/issues/1081) Union: 精度のために、内部のリングを見逃す可能性があった問題を修正
- バグ修正
    - [GitHub #1063](https://github.com/boostorg/geometry/issues/1063) Intersection: 単純な球面ポリゴンの交差のバグを修正
    - [GitHub #1064](https://github.com/boostorg/geometry/issues/1064) Formulas: 測地線直接式 (geodesic direct formulas) の一貫性の問題を修正
    - [GitHub #1088](https://github.com/boostorg/geometry/issues/1088) Point: custom point typeのリグレッションを修正
    - 不足していたインクルードファイル、警告、C++20でのコンパイルエラー、ドキュメントに関するさまざまな修正


## <a id="iterator" href="#iterator">Iterator</a>

- [GitHub #73](https://github.com/boostorg/iterator/pull/73) `function_output_iterator` は、代入された値のラップされた関数オブジェクトへの完全転送をサポートするようになった
- [GitHub #75](https://github.com/boostorg/iterator/issues/75) 別の `function_input_iterator` の後置インクリメントの結果から `function_input_iterator` を構築する際のコンパイルエラーを修正
- `iterator_facade` に基づくイテレータの後置インクリメントの戻り値型が、`operator->` をサポートするようになりました。 `(it++)->foo` は、以前にサポートされていた `(*it++).foo` と等価


## <a id="json" href="#json">JSON</a>

- `object::stable_erase`を追加
- `parse`に`std::istream`のオーバーロードを追加、`operator>>`に`value`のオーバーロードを追加
- `value`に右辺値修飾のアクセッサを追加
- Conversion traitsを再設計
- describedなクラス、enum、`std::optional`、`std::variant`、null-likeな型 (`std::nullptr_t`, `std::nullopt_t`, `std::monotype`を含む) の変換をサポート
- `value`からユーザー定義型への例外を投げない変換を追加


## <a id="locale" href="#locale">Locale</a>

- **いくつかの破壊的変更を含むメジャーアップデート**
- C++11 のサポートが必要になった。C++03 以前のサポートは廃止された
- 一部のenumはenum classに変換された。名前の競合を回避する
- `-sICU_LINK_LOCALE` と `-sICU_LINK` を、Boost.RegEx で行われるように、きめの細かい設定オプションに置き換える
- libiconv の検出を修正し、一部のプラットフォームで Boost.Locale を (再び) ビルドできるようにしました。
- `std::auto_ptr` の使用とサポートを削除
- Windows で `wchar_t` を使用して `codecvt` が UTF-16 エンコーディングを想定・使用するようにした
- パフォーマンスを向上: `basic_format`、`date_time`、`hold_ptr`をムーブ可能にし、フォーマットキャッシュの使用を修正
- Boost.Locale をより多くの ICU バージョンと互換性を持たせるようにした (特にテスト)
- 一部のクラスの RTTI 定義を修正 (可視性の問題)
- 一部の libc++ バージョンとの ICU バックエンドの互換性を修正
- 一部の演算子の戻り値を修正して、const でない `*this` を正しく返すようにした
- `date_time` の負のロールの int-overflow を修正
- ビルドログをきれいにする多くの警告を処理または抑制
- より多くの Windows コードページのサポートを追加
- ISO-2022-JP などの Windows コードページのサポートを修正


## <a id="multi-index" href="#multi-index">Multi-index</a>

- メンテナンス作業


## <a id="nowide" href="#nowide">Nowide</a>

- MSVCのテストがビルド失敗する問題を修正


## <a id="stl-interfaces" href="#stl-interfaces">STLInterfaces</a>

- `const value_type`を持つC++20より前のイテレータの2つの不適格な形式の`iterator_interface`演算子を修正


## <a id="system" href="#system">System</a>

- マクロ `BOOST_SYSTEM_DISABLE_THREADS` を定義して、`<mutex>` の使用を無効にできるようになった (例: シングルスレッドの libstdc++)
- `result<>`に`value_type`, `error_type`, `in_place_value`, `in_place_error`を追加
- `result<>`に`emplace()`を追加


## <a id="unordered" href="#unordered">Unordered</a>

- **メジャーアップデート**
- オープンアドレッシングに基づく高速なコンテナとして`boost::unordered_flat_map`と`boost::unordered_flat_set`を追加
- すべてのコンテナにCTAD推論ガイドを追加
- [LWG issue 2713](https://cplusplus.github.io/LWG/issue2713)で規定された、不足していたコンストラクタを追加


## <a id="variant2" href="#variant2">Variant2</a>

- `boost::json::value_from`と`boost::json::value_to`のサポートを追加




## テスト済みコンパイラ
主要なテストコンパイラ:

- Linux:
    - Clang: 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 12.0.0, 13.0.0, 14.0.0, 15.0.0
    - Clang, C++11: 3.4, 11.0.0, 13.0.0, 14.0.0, 15.0.0
    - Clang, C++14: 3.5, 3.6, 3.7, 3.8, 3.9, 4.0, 5.0, 12.0.0, 13.0.0, 14.0.0, 15.0.0
    - Clang, C++17: 6.0.1, 7.0.0, 8.0.0, 9.0.0, 10.0.0, 11.0.0, 12.0.0, 13.0.0, 14.0.0, 15.0.0
    - Clang, C++20: 11.0.0, 12.0.0, 13.0.0, 14.0.0, 15.0.0
    - GCC: 4.6.3, 11, 12
    - GCC, C++11: 4.7.3, 4.8.5, 11, 12
    - GCC, C++14: 5.4.0, 6.4.0, 7.3.0, 8.0.1, 9.1.0, 11, 12
    - GCC, C++17: 7.3.0, 8.0.1, 9.1.0, 11, 12
    - GCC, C++20: 8.0.1, 9.1.0, 10, 11, 12
- OS X:
    - Apple Clang: 11.0.3
    - Apple Clang, C++11: 11.0.3
    - Apple Clang, C++14: 11.0.3
    - Apple Clang, C++17: 11.0.3
    - Apple Clang, C++20: 11.0.3
- Windows:
    - Visual C++: 10.0, 11.0, 12.0, 14.0, 14.1, 14.2, 14.3

## 翻訳
[Akira Takahashi](https://github.com/faithandbrave)

